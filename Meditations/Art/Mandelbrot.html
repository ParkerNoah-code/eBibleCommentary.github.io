<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="../../style.css" />
    <script
      rel="script"
      type="text/javascript"
      src="../../functions.js"
    ></script>
  </head>
  <body>
    <div class="container">
      <header><h1>Mandelbrot</h1></header>
      <ul>
        <li>
          <a href="../../index.html">About</a> |
          <a href="../../Meditations.html"> Meditations</a> |
          <a href="../../OT.html"> Old Testament</a> |
          <a href="../../NT.html"> New Testament</a>
        </li>
      </ul>

      <section>
        <h2>The Mandelbrot Set</h2>

        <div id="mandelbrotContainer">
          <canvas id="mandelbrotCanvas"></canvas>
        </div>

        <script>
          let canvas = document.getElementById("mandelbrotCanvas");
          let ctx = canvas.getContext("2d");
          let zoom = 1;
          let offsetX = -0.5;
          let offsetY = 0;
          let targetZoom = 2;
          let targetOffsetX = -0.74364388703;
          let targetOffsetY = 0.13182590421;

          function updateZoom() {
            // Adjust zoom and offsets for smooth transition
            zoom += (targetZoom - zoom) * 0.01;
            offsetX += (targetOffsetX - offsetX) * 0.01;
            offsetY += (targetOffsetY - offsetY) * 0.01;

            // Render the Mandelbrot set with current parameters
            mandelbrotSet(canvas, ctx, zoom, offsetX, offsetY);

            // Find the brightest pixel and update the target offsets
            let brightest = findBrightestPixel(
              ctx,
              canvas.width,
              canvas.height
            );
            targetOffsetX =
              ((brightest.x - canvas.width / 2) * (4 / canvas.width)) / zoom +
              offsetX;
            targetOffsetY =
              ((brightest.y - canvas.height / 2) * (4 / canvas.width)) / zoom +
              offsetY;
            targetZoom *= 1.01; // Gradually increase the zoom level

            // Use requestAnimationFrame for smooth animation
            requestAnimationFrame(updateZoom);
          }

          // Call updateZoom to start the process
          updateZoom();
        </script>
      </section>

      <footer><p>&copy; 2023 ebiblecommentary. All rights reserved.</p></footer>
    </div>
  </body>
</html>
